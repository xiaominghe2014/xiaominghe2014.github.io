
const _ = -1; // no map
const f = 0;  // floor
const p = 1;  // player
const w = 1 << 1; // wall
const x = 1 << 2; // box
const o = 1 << 3; // target


const char_player = '@';
const char_player_goal = '+';
const char_box = '$';
const char_box_goal = '*';
const char_wall = '#';
const char_goal = '.';
const char_floor = '-';
const char_no = '_';

function XSB2Map(xsbArr) {
    let map = [];
    for (let str of xsbArr) {
        let arr = [];
        for (let i = 0; i < str.length; i++) {
            let c = str[i];
            if (c === char_player) {
                arr.push(p);
            }
            if (c === char_player_goal) {
                arr.push(p | o);
            }
            if (c === char_box) {
                arr.push(x);
            }
            if (c === char_box_goal) {
                arr.push(x | o);
            }
            if (c === char_wall) {
                arr.push(w);
            }
            if (c === char_goal) {
                arr.push(o);
            }
            if (c === char_floor) {
                arr.push(f);
            }
            if (c === char_no || c == ' ') {
                arr.push(_);
            }
        }
        if (arr.length > 0) {
            map.push(arr);
        }
    }
    return map;
}

let mapStrArr = [
    // 入门
    [
        "#####",
        "#@$.#",
        "#####"
    ],
    [
        "####__",
        "#-.#__",
        "#--###",
        "#*@--#",
        "#--$-#",
        "#--###",
        "####__"
    ],
    [
        "######",
        "#----#",
        "#-#@-#",
        "#-$*-#",
        "#-.*-#",
        "#----#",
        "######"
    ],

    [
        "__####___",
        "###--####",
        "#-----$-#",
        "#-#--#$-#",
        "#-.-.#@-#",
        "#########"
    ],
    [
        "########",
        "#------#",
        "#-.**$@#",
        "#------#",
        "#####--#",
        "____####"
    ],

    [
        "_#######",
        "_#-----#",
        "_#-.$.-#",
        "##-$@$-#",
        "#--.$.-#",
        "#------#",
        "########"
    ],

    [
        "#######",
        "#-----#",
        "#-.$.-#",
        "#-$.$-#",
        "#-.$.-#",
        "#-$.$-#",
        "#--@--#",
        "#######"
    ],

    [
        "#####____",
        "#---##___",
        "#-$--#___",
        "##-$-####",
        "_###@.--#",
        "__#--.#-#",
        "__#-----#",
        "__#######"
    ],
    [
        "####___________",
        "#--############",
        "#-$-$-$-$-$-@-#",
        "#-.....-------#",
        "###############"
    ],
    [
        "######",
        "#...-#",
        "#--$-#",
        "#-#$##",
        "#--$-#",
        "#--@-#",
        "######"
    ],
    [
        "_######",
        "##----#",
        "#--##-#",
        "#-#-$-#",
        "#--*-.#",
        "##-#@##",
        "_#---#_",
        "_#####_"
    ],
    [
        "####___",
        "#--####",
        "#-.-.-#",
        "#-$$#@#",
        "##----#",
        "_#####_",
    ],
    [
        "######",
        "#-#-.#",
        "#-$-.#",
        "#@-$.#",
        "#-$$.#",
        "#--###",
        "####__",
    ],
    [
        "__####_",
        "##---#_",
        "#----##",
        "#-$-$-#",
        "#--#$@#",
        "#...-##",
        "######_",
    ],
    [
        "#####____",
        "#@--#____",
        "#-$$#_###",
        "#-$-#_#.#",
        "###-###.#",
        "_##----.#",
        "_#---#--#",
        "_#---####",
        "_#####___",
    ],
    [
        "_#######__",
        "_#-----###",
        "##$###---#",
        "#-@-$--$-#",
        "#-..#-$-##",
        "##..#---#_",
        "_########_",
    ],
    [
        "__####",
        "_##@.#",
        "_#.$$#",
        "##-$-#",
        "#-.#-#",
        "#----#",
        "#--###",
        "#--#__",
        "####__",
    ],
    [
        "_####_",
        "##--#_",
        "#@$-#_",
        "##$-##",
        "##-$-#",
        "#.$--#",
        "#..*.#",
        "######",
    ],
    [
        "__####__",
        "__#..#__",
        "_##-.##_",
        "_#--$.#_",
        "##-$--##",
        "#--#$$-#",
        "#--@---#",
        "########",
    ],

    [
        "###########",
        "#@---#----#",
        "#-$-.$.-$-#",
        "#--.-.-.--#",
        "####.#.####",
        "#--$-.-$--#",
        "#-$--$--$-#",
        "#----#----#",
        "###########",
    ],

    // 进阶
    [
        "_######_",
        "##----##",
        "#-$-$$-#",
        "#......#",
        "#-$$-$-#",
        "###-@###",
        "__####__",
    ],
    [
        "########",
        "#.-*---#",
        "#-#-$#.#",
        "#---$-.#",
        "####$--#",
        "#@---#-#",
        "#.$----#",
        "########",
    ],
    [
        "__#####_",
        "###---#_",
        "#.@$--#_",
        "###-$.#_",
        "#.##$-#_",
        "#-#-.-##",
        "#$-*$$.#",
        "#---.--#",
        "########",
    ],
    [
        "_######_",
        "_#--.@##",
        "_#---$.#",
        "_###*#-#",
        "##-----#",
        "#--$--##",
        "#---###_",
        "#####___",
    ],
    [
        "#######__",
        "#-----#__",
        "#-$$$##__",
        "#--#..###",
        "##--..$-#",
        "_#-@----#",
        "_########",
    ],
    [
        "____####",
        "#####-.#",
        "#-.*@$-#",
        "#--$$$-#",
        "#--#---#",
        "#.-.-###",
        "######__"
    ],
    [
        "____#####__________",
        "____#---#__________",
        "____#$--#__________",
        "__###--$##_________",
        "__#--$-$-#_________",
        "###-#-##-#___######",
        "#---#-##-#####--..#",
        "#-$--$----------..#",
        "#####-###-#@##--..#",
        "____#-----#########",
        "____######_________",
    ],

    //uluu3l5u3rurr4d4l4r4ulld3l
    //4drd6lul3duu6ruu5rdd8ldlur
    //ulldluuruluu6r3d4rdrd8ldlu
    //rulldl3urul4d9ruru3ldl3udd
    //5r4ulld9l5d12r5d4l4uru8lu
    //ddu11r5u10ldluruld6r3d3rur
    //uru10ldlu5d8rddrruluurrd
    //10luld8r5drr9uru9l4r5d5l
    //5u5d11rdlldl3uru3ldl3udd
    //4r3u8l8rdr3dlddrru9ldlur
    //uldl3u3d11r4dldl3uluurrd
    //lldluru6ldluruldluudd9r4
    //ldl4uru6ldlurulldluudd8r
    //3drdruuluurrdlldluru6ldl
    //urulldlud12rdd3ldluuru6l
    //dlurulld11r3d3ldl3uru8l
    [
        "#####_____#####_",
        "#...#######---#_",
        "#.-.--------$-#_",
        "#.-.####-###$-#_",
        "#...#--#-##-$-#_",
        "_#.-####----$-#_",
        "_#.---##--#-$-##",
        "_#.---------$--#",
        "_#.#--####-$$$-#",
        "_#.####__#-$-$-#",
        "_#.#_____#-$@$-#",
        "_###_____#-$$$-#",
        "_________#-----#",
        "_________#######",
    ],

    //无人区
    [
        "###########",
        "#----.----#",
        "#--$.$.$--#",
        "###.$.$.###",
        "__##.$.##__",
        "___#$.$#___",
        "___#-$-#___",
        "___#-@-#___",
        "___#####___",
    ],
    [
        "_________####_",
        "##########--#_",
        "#-----------#_",
        "#--********-#_",
        "_#-*------*-#_",
        "_#-*-####-*-#_",
        "_#-*-#__#-*-#_",
        "_#-*-#__#-*-#_",
        "_#-*-####-*-#_",
        "_#-*----#-*-#_",
        "_#-****.#-*-#_",
        "_#------#-*-#_",
        "_#--#####-*-#_",
        "_####__#--*-##",
        "_______#-**--#",
        "_______#---$@#",
        "_______###--#_",
        "_________####_",
    ],
];


